import * as ___react___ from 'react';
import * as ___react_dom___ from 'react-dom'; 

function require(mod) {
  if (mod === 'react') return ___react___;
  if (mod === 'react-dom') return ___react_dom___;
  throw new Error(`Unknown module ${mod}`);
}
import{a as q}from"../../chunk-ZUEQ555M.js";import{b as u}from"../../chunk-SXTJF4PD.js";import{e as d}from"../../chunk-GDQBQ7MK.js";d();function h(n){return{async execute(o,i){let{abortSignal:r}=i||{};if(!r)try{let[e]=await n.query(o.sql,o.parameters);return[null,l(e)]}catch(e){return[e]}if(r.aborted)return u();let a,t;try{let e,s=new Promise(w=>e=w);r.addEventListener("abort",a=()=>e());let c=n.getConnection(),f=await Promise.race([c,s]);if(!f)return c.catch(()=>{}),u();if(t=f,r.aborted)return t.release(),u();let m=(t||n).query(o.sql,o.parameters),y=await Promise.race([m,s]);if(!y)return Promise.allSettled([v(n,y),m]).finally(()=>t?.release()),u();t.release();let[P]=y;return[null,l(P)]}catch(e){return t?.release(),[e]}finally{a&&r?.removeEventListener("abort",a)}},async executeSequence(o,i){let r;try{r=await n.getConnection();let[a,t]=o,[e]=await r.query(a.sql,a.parameters).catch(c=>[c]);if(e instanceof Error)return[[e]];let[s]=await r.query(t.sql,t.parameters).catch(c=>[c]);return s instanceof Error?[[null,l(e)],[s]]:[[null,l(e)],[null,l(s)]]}catch(a){return[[a]]}finally{r?.release()}}}}function l(n){return Array.isArray(n)?n:[n]}async function v(n,o){let i=q(o);try{await n.query(i.sql,i.parameters)}catch(r){console.error("Failed to cancel query:",r)}}export{h as createMySQL2Executor};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vZGF0YS9teXNxbDIvaW5kZXgudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB0eXBlIHsgUG9vbCwgUG9vbENvbm5lY3Rpb24gfSBmcm9tIFwibXlzcWwyL3Byb21pc2VcIjtcblxuaW1wb3J0IHsgZ2V0QWJvcnRSZXN1bHQsIHR5cGUgU2VxdWVuY2VFeGVjdXRvciB9IGZyb20gXCIuLi9leGVjdXRvclwiO1xuaW1wb3J0IHsgZ2V0Q2FuY2VsUXVlcnkgfSBmcm9tIFwiLi4vbXlzcWwtY29yZS91dGlsaXR5XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVNeVNRTDJFeGVjdXRvcihwb29sOiBQb29sKTogU2VxdWVuY2VFeGVjdXRvciB7XG4gIHJldHVybiB7XG4gICAgYXN5bmMgZXhlY3V0ZShxdWVyeSwgb3B0aW9ucykge1xuICAgICAgY29uc3QgeyBhYm9ydFNpZ25hbCB9ID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgaWYgKCFhYm9ydFNpZ25hbCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgcG9vbC5xdWVyeShxdWVyeS5zcWwsIHF1ZXJ5LnBhcmFtZXRlcnMpO1xuXG4gICAgICAgICAgcmV0dXJuIFtudWxsLCBhc0FycmF5KHJlc3VsdCldIGFzIG5ldmVyO1xuICAgICAgICB9IGNhdGNoIChlcnJvcjogdW5rbm93bikge1xuICAgICAgICAgIHJldHVybiBbZXJyb3IgYXMgRXJyb3JdO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChhYm9ydFNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgIHJldHVybiBnZXRBYm9ydFJlc3VsdCgpO1xuICAgICAgfVxuXG4gICAgICBsZXQgYWJvcnRMaXN0ZW5lcjogKCgpID0+IHZvaWQpIHwgdW5kZWZpbmVkO1xuICAgICAgbGV0IGNvbm5lY3Rpb246IFBvb2xDb25uZWN0aW9uIHwgdW5kZWZpbmVkO1xuXG4gICAgICB0cnkge1xuICAgICAgICBsZXQgYWJvcnRlZDogKCkgPT4gdm9pZDtcbiAgICAgICAgY29uc3QgYWJvcnRpb25Qcm9taXNlID0gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUpID0+IChhYm9ydGVkID0gcmVzb2x2ZSkpO1xuXG4gICAgICAgIGFib3J0U2lnbmFsLmFkZEV2ZW50TGlzdGVuZXIoXCJhYm9ydFwiLCAoYWJvcnRMaXN0ZW5lciA9ICgpID0+IGFib3J0ZWQoKSkpO1xuXG4gICAgICAgIGNvbnN0IGNvbm5lY3Rpb25Qcm9taXNlID0gcG9vbC5nZXRDb25uZWN0aW9uKCk7XG5cbiAgICAgICAgY29uc3QgY29ubmVjdGlvblJlc3VsdCA9IGF3YWl0IFByb21pc2UucmFjZShbY29ubmVjdGlvblByb21pc2UsIGFib3J0aW9uUHJvbWlzZV0pO1xuXG4gICAgICAgIGlmICghY29ubmVjdGlvblJlc3VsdCkge1xuICAgICAgICAgIHZvaWQgY29ubmVjdGlvblByb21pc2UuY2F0Y2goKCkgPT4ge30pO1xuXG4gICAgICAgICAgcmV0dXJuIGdldEFib3J0UmVzdWx0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25uZWN0aW9uID0gY29ubmVjdGlvblJlc3VsdDtcblxuICAgICAgICBpZiAoYWJvcnRTaWduYWwuYWJvcnRlZCkge1xuICAgICAgICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpO1xuXG4gICAgICAgICAgcmV0dXJuIGdldEFib3J0UmVzdWx0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBxdWVyeVByb21pc2UgPSAoY29ubmVjdGlvbiB8fCBwb29sKS5xdWVyeShxdWVyeS5zcWwsIHF1ZXJ5LnBhcmFtZXRlcnMpO1xuXG4gICAgICAgIGNvbnN0IHF1ZXJ5UmVzdWx0ID0gYXdhaXQgUHJvbWlzZS5yYWNlKFtxdWVyeVByb21pc2UsIGFib3J0aW9uUHJvbWlzZV0pO1xuXG4gICAgICAgIGlmICghcXVlcnlSZXN1bHQpIHtcbiAgICAgICAgICAvLyBub3QgaW1wb3J0YW50IGVub3VnaCB0byBhd2FpdC5cbiAgICAgICAgICB2b2lkIFByb21pc2UuYWxsU2V0dGxlZChbY2FuY2VsUXVlcnkocG9vbCwgcXVlcnlSZXN1bHQpLCBxdWVyeVByb21pc2VdKS5maW5hbGx5KCgpID0+IGNvbm5lY3Rpb24/LnJlbGVhc2UoKSk7XG5cbiAgICAgICAgICByZXR1cm4gZ2V0QWJvcnRSZXN1bHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpO1xuXG4gICAgICAgIGNvbnN0IFtyZXN1bHRdID0gcXVlcnlSZXN1bHQ7XG5cbiAgICAgICAgcmV0dXJuIFtudWxsLCBhc0FycmF5KHJlc3VsdCldIGFzIG5ldmVyO1xuICAgICAgfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHtcbiAgICAgICAgY29ubmVjdGlvbj8ucmVsZWFzZSgpO1xuXG4gICAgICAgIHJldHVybiBbZXJyb3IgYXMgRXJyb3JdO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKGFib3J0TGlzdGVuZXIpIHtcbiAgICAgICAgICBhYm9ydFNpZ25hbD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFib3J0XCIsIGFib3J0TGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIFRPRE86IGFib3J0IHNpZ25hbCBoYW5kbGluZ1xuICAgIC8vIFRPRE86IHRyYW5zYWN0aW9uP1xuICAgIGFzeW5jIGV4ZWN1dGVTZXF1ZW5jZShzZXF1ZW5jZSwgX29wdGlvbnMpIHtcbiAgICAgIGxldCBjb25uZWN0aW9uOiBQb29sQ29ubmVjdGlvbiB8IHVuZGVmaW5lZDtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29ubmVjdGlvbiA9IGF3YWl0IHBvb2wuZ2V0Q29ubmVjdGlvbigpO1xuXG4gICAgICAgIGNvbnN0IFtxdWVyeTAsIHF1ZXJ5MV0gPSBzZXF1ZW5jZTtcblxuICAgICAgICBjb25zdCBbcmVzdWx0MF0gPSBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KHF1ZXJ5MC5zcWwsIHF1ZXJ5MC5wYXJhbWV0ZXJzKS5jYXRjaCgoZXJyb3IpID0+IFtlcnJvciBhcyBFcnJvcl0pO1xuXG4gICAgICAgIGlmIChyZXN1bHQwIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICByZXR1cm4gW1tyZXN1bHQwXV07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBbcmVzdWx0MV0gPSBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KHF1ZXJ5MS5zcWwsIHF1ZXJ5MS5wYXJhbWV0ZXJzKS5jYXRjaCgoZXJyb3IpID0+IFtlcnJvciBhcyBFcnJvcl0pO1xuXG4gICAgICAgIGlmIChyZXN1bHQxIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICByZXR1cm4gW1tudWxsLCBhc0FycmF5KHJlc3VsdDApXSwgW3Jlc3VsdDFdXSBhcyBuZXZlcjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgW251bGwsIGFzQXJyYXkocmVzdWx0MCldLFxuICAgICAgICAgIFtudWxsLCBhc0FycmF5KHJlc3VsdDEpXSxcbiAgICAgICAgXSBhcyBuZXZlcjtcbiAgICAgIH0gY2F0Y2ggKGVycm9yOiB1bmtub3duKSB7XG4gICAgICAgIHJldHVybiBbW2Vycm9yIGFzIEVycm9yXV07XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBjb25uZWN0aW9uPy5yZWxlYXNlKCk7XG4gICAgICB9XG4gICAgfSxcbiAgfTtcbn1cblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmZ1bmN0aW9uIGFzQXJyYXk8VD4odmFsdWU6IFQpOiBUIGV4dGVuZHMgYW55W10gPyBUIDogVFtdIHtcbiAgcmV0dXJuIChBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXSkgYXMgbmV2ZXI7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNhbmNlbFF1ZXJ5KHBvb2w6IFBvb2wsIHRocmVhZElkOiB1bmtub3duKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHF1ZXJ5ID0gZ2V0Q2FuY2VsUXVlcnkodGhyZWFkSWQpO1xuXG4gIHRyeSB7XG4gICAgYXdhaXQgcG9vbC5xdWVyeShxdWVyeS5zcWwsIHF1ZXJ5LnBhcmFtZXRlcnMpO1xuICB9IGNhdGNoIChlcnJvcjogdW5rbm93bikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gY2FuY2VsIHF1ZXJ5OlwiLCBlcnJvcik7XG4gIH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7O29JQUFBQSxJQUtPLFNBQVNDLEVBQXFCQyxFQUE4QixDQUNqRSxNQUFPLENBQ0wsTUFBTSxRQUFRQyxFQUFPQyxFQUFTLENBQzVCLEdBQU0sQ0FBRSxZQUFBQyxDQUFZLEVBQUlELEdBQVcsQ0FBQyxFQUVwQyxHQUFJLENBQUNDLEVBQ0gsR0FBSSxDQUNGLEdBQU0sQ0FBQ0MsQ0FBTSxFQUFJLE1BQU1KLEVBQUssTUFBTUMsRUFBTSxJQUFLQSxFQUFNLFVBQVUsRUFFN0QsTUFBTyxDQUFDLEtBQU1JLEVBQVFELENBQU0sQ0FBQyxDQUMvQixPQUFTRSxFQUFnQixDQUN2QixNQUFPLENBQUNBLENBQWMsQ0FDeEIsQ0FHRixHQUFJSCxFQUFZLFFBQ2QsT0FBT0ksRUFBZSxFQUd4QixJQUFJQyxFQUNBQyxFQUVKLEdBQUksQ0FDRixJQUFJQyxFQUNFQyxFQUFrQixJQUFJLFFBQWVDLEdBQWFGLEVBQVVFLENBQVEsRUFFMUVULEVBQVksaUJBQWlCLFFBQVVLLEVBQWdCLElBQU1FLEVBQVEsQ0FBRSxFQUV2RSxJQUFNRyxFQUFvQmIsRUFBSyxjQUFjLEVBRXZDYyxFQUFtQixNQUFNLFFBQVEsS0FBSyxDQUFDRCxFQUFtQkYsQ0FBZSxDQUFDLEVBRWhGLEdBQUksQ0FBQ0csRUFDSCxPQUFLRCxFQUFrQixNQUFNLElBQU0sQ0FBQyxDQUFDLEVBRTlCTixFQUFlLEVBS3hCLEdBRkFFLEVBQWFLLEVBRVRYLEVBQVksUUFDZCxPQUFBTSxFQUFXLFFBQVEsRUFFWkYsRUFBZSxFQUd4QixJQUFNUSxHQUFnQk4sR0FBY1QsR0FBTSxNQUFNQyxFQUFNLElBQUtBLEVBQU0sVUFBVSxFQUVyRWUsRUFBYyxNQUFNLFFBQVEsS0FBSyxDQUFDRCxFQUFjSixDQUFlLENBQUMsRUFFdEUsR0FBSSxDQUFDSyxFQUVILE9BQUssUUFBUSxXQUFXLENBQUNDLEVBQVlqQixFQUFNZ0IsQ0FBVyxFQUFHRCxDQUFZLENBQUMsRUFBRSxRQUFRLElBQU1OLEdBQVksUUFBUSxDQUFDLEVBRXBHRixFQUFlLEVBR3hCRSxFQUFXLFFBQVEsRUFFbkIsR0FBTSxDQUFDTCxDQUFNLEVBQUlZLEVBRWpCLE1BQU8sQ0FBQyxLQUFNWCxFQUFRRCxDQUFNLENBQUMsQ0FDL0IsT0FBU0UsRUFBZ0IsQ0FDdkIsT0FBQUcsR0FBWSxRQUFRLEVBRWIsQ0FBQ0gsQ0FBYyxDQUN4QixRQUFFLENBQ0lFLEdBQ0ZMLEdBQWEsb0JBQW9CLFFBQVNLLENBQWEsQ0FFM0QsQ0FDRixFQUlBLE1BQU0sZ0JBQWdCVSxFQUFVQyxFQUFVLENBQ3hDLElBQUlWLEVBRUosR0FBSSxDQUNGQSxFQUFhLE1BQU1ULEVBQUssY0FBYyxFQUV0QyxHQUFNLENBQUNvQixFQUFRQyxDQUFNLEVBQUlILEVBRW5CLENBQUNJLENBQU8sRUFBSSxNQUFNYixFQUFXLE1BQU1XLEVBQU8sSUFBS0EsRUFBTyxVQUFVLEVBQUUsTUFBT2QsR0FBVSxDQUFDQSxDQUFjLENBQUMsRUFFekcsR0FBSWdCLGFBQW1CLE1BQ3JCLE1BQU8sQ0FBQyxDQUFDQSxDQUFPLENBQUMsRUFHbkIsR0FBTSxDQUFDQyxDQUFPLEVBQUksTUFBTWQsRUFBVyxNQUFNWSxFQUFPLElBQUtBLEVBQU8sVUFBVSxFQUFFLE1BQU9mLEdBQVUsQ0FBQ0EsQ0FBYyxDQUFDLEVBRXpHLE9BQUlpQixhQUFtQixNQUNkLENBQUMsQ0FBQyxLQUFNbEIsRUFBUWlCLENBQU8sQ0FBQyxFQUFHLENBQUNDLENBQU8sQ0FBQyxFQUd0QyxDQUNMLENBQUMsS0FBTWxCLEVBQVFpQixDQUFPLENBQUMsRUFDdkIsQ0FBQyxLQUFNakIsRUFBUWtCLENBQU8sQ0FBQyxDQUN6QixDQUNGLE9BQVNqQixFQUFnQixDQUN2QixNQUFPLENBQUMsQ0FBQ0EsQ0FBYyxDQUFDLENBQzFCLFFBQUUsQ0FDQUcsR0FBWSxRQUFRLENBQ3RCLENBQ0YsQ0FDRixDQUNGLENBR0EsU0FBU0osRUFBV21CLEVBQXFDLENBQ3ZELE9BQVEsTUFBTSxRQUFRQSxDQUFLLEVBQUlBLEVBQVEsQ0FBQ0EsQ0FBSyxDQUMvQyxDQUVBLGVBQWVQLEVBQVlqQixFQUFZeUIsRUFBa0MsQ0FDdkUsSUFBTXhCLEVBQVF5QixFQUFlRCxDQUFRLEVBRXJDLEdBQUksQ0FDRixNQUFNekIsRUFBSyxNQUFNQyxFQUFNLElBQUtBLEVBQU0sVUFBVSxDQUM5QyxPQUFTSyxFQUFnQixDQUN2QixRQUFRLE1BQU0sMEJBQTJCQSxDQUFLLENBQ2hELENBQ0YiLAogICJuYW1lcyI6IFsiaW5pdF9kZWZpbmVfQUNDRUxFUkFURV9TQ0hFTUFfQllfUFJPVklERVIiLCAiY3JlYXRlTXlTUUwyRXhlY3V0b3IiLCAicG9vbCIsICJxdWVyeSIsICJvcHRpb25zIiwgImFib3J0U2lnbmFsIiwgInJlc3VsdCIsICJhc0FycmF5IiwgImVycm9yIiwgImdldEFib3J0UmVzdWx0IiwgImFib3J0TGlzdGVuZXIiLCAiY29ubmVjdGlvbiIsICJhYm9ydGVkIiwgImFib3J0aW9uUHJvbWlzZSIsICJyZXNvbHZlIiwgImNvbm5lY3Rpb25Qcm9taXNlIiwgImNvbm5lY3Rpb25SZXN1bHQiLCAicXVlcnlQcm9taXNlIiwgInF1ZXJ5UmVzdWx0IiwgImNhbmNlbFF1ZXJ5IiwgInNlcXVlbmNlIiwgIl9vcHRpb25zIiwgInF1ZXJ5MCIsICJxdWVyeTEiLCAicmVzdWx0MCIsICJyZXN1bHQxIiwgInZhbHVlIiwgInRocmVhZElkIiwgImdldENhbmNlbFF1ZXJ5Il0KfQo=