"use strict";var l=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var v=Object.prototype.hasOwnProperty;var T=(e,r)=>{for(var n in r)l(e,n,{get:r[n],enumerable:!0})},k=(e,r,n,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of P(r))!v.call(e,o)&&o!==n&&l(e,o,{get:()=>r[o],enumerable:!(t=E(r,o))||t.enumerable});return e};var q=e=>k(l({},"__esModule",{value:!0}),e);var C={};T(C,{createPostgresJSExecutor:()=>h});module.exports=q(C);var c=class extends Error{constructor(){super("This operation was aborted"),this.name="AbortError"}};function i(){return[new c]}function R(e){return typeof e=="string"?{parameters:[],sql:e}:e}function g(){return R("select pg_backend_pid() as pid")}function b(e){return{parameters:[e],sql:"select pg_cancel_backend($1);"}}function h(e){return{execute:async(r,n)=>{let{abortSignal:t}=n||{};if(!t)try{return[null,await e.unsafe(r.sql,r.parameters)]}catch(a){return[a]}if(t.aborted)return i();let o,s;try{let a,u=new Promise(Q=>a=Q);t.addEventListener("abort",o=()=>a());let y=e.reserve(),d=await Promise.race([y,u]);if(!d)return y.catch(()=>{}),i();if(s=d,t.aborted)return s.release(),i();let m=O(s),f=await Promise.race([m,u]);if(f===void 0)return m.catch(()=>{}).finally(()=>s?.release()),i();if(t.aborted)return s.release(),i();let x=s.unsafe(r.sql,r.parameters),w=await Promise.race([x,u]);return w?(s.release(),[null,w]):(Promise.allSettled([B(e,f),x]).finally(()=>s?.release()),i())}catch(a){return s?.release(),[a]}finally{o&&t?.removeEventListener("abort",o)}}}}async function B(e,r){let n=b(r);try{await e.unsafe(n.sql,n.parameters)}catch(t){console.error("Failed to cancel query:",t)}}async function O(e){let r=g();try{let[n]=await e.unsafe(r.sql,r.parameters);return n?.pid}catch(n){console.error("Failed to get connection PID:",n);return}}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vZGF0YS9wb3N0Z3Jlc2pzL2luZGV4LnRzIiwgIi4uLy4uLy4uL2RhdGEvZXhlY3V0b3IudHMiLCAiLi4vLi4vLi4vZGF0YS9xdWVyeS50cyIsICIuLi8uLi8uLi9kYXRhL3Bvc3RncmVzLWNvcmUvdXRpbGl0eS50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHR5cGUgeyBSZXNlcnZlZFNxbCwgU3FsIH0gZnJvbSBcInBvc3RncmVzXCI7XG5cbmltcG9ydCB7IHR5cGUgRXhlY3V0b3IsIGdldEFib3J0UmVzdWx0IH0gZnJvbSBcIi4uL2V4ZWN1dG9yXCI7XG5pbXBvcnQgeyBnZXRDYW5jZWxRdWVyeSwgZ2V0UElEUXVlcnkgfSBmcm9tIFwiLi4vcG9zdGdyZXMtY29yZS91dGlsaXR5XCI7XG5pbXBvcnQgdHlwZSB7IFF1ZXJ5UmVzdWx0IH0gZnJvbSBcIi4uL3F1ZXJ5XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQb3N0Z3Jlc0pTRXhlY3V0b3IocG9zdGdyZXNqczogU3FsKTogRXhlY3V0b3Ige1xuICByZXR1cm4ge1xuICAgIGV4ZWN1dGU6IGFzeW5jIChxdWVyeSwgb3B0aW9ucykgPT4ge1xuICAgICAgY29uc3QgeyBhYm9ydFNpZ25hbCB9ID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgaWYgKCFhYm9ydFNpZ25hbCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBvc3RncmVzanMudW5zYWZlKHF1ZXJ5LnNxbCwgcXVlcnkucGFyYW1ldGVycyBhcyBuZXZlcik7XG5cbiAgICAgICAgICByZXR1cm4gW251bGwsIHJlc3VsdCBhcyBuZXZlcl07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yOiB1bmtub3duKSB7XG4gICAgICAgICAgcmV0dXJuIFtlcnJvciBhcyBFcnJvcl07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGFib3J0U2lnbmFsLmFib3J0ZWQpIHtcbiAgICAgICAgcmV0dXJuIGdldEFib3J0UmVzdWx0KCk7XG4gICAgICB9XG5cbiAgICAgIGxldCBhYm9ydExpc3RlbmVyOiAoKCkgPT4gdm9pZCkgfCB1bmRlZmluZWQ7XG4gICAgICBsZXQgY29ubmVjdGlvbjogUmVzZXJ2ZWRTcWwgfCB1bmRlZmluZWQ7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGxldCBhYm9ydGVkOiAoKSA9PiB2b2lkO1xuICAgICAgICBjb25zdCBhYm9ydGlvblByb21pc2UgPSBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSkgPT4gKGFib3J0ZWQgPSByZXNvbHZlKSk7XG5cbiAgICAgICAgYWJvcnRTaWduYWwuYWRkRXZlbnRMaXN0ZW5lcihcImFib3J0XCIsIChhYm9ydExpc3RlbmVyID0gKCkgPT4gYWJvcnRlZCgpKSk7XG5cbiAgICAgICAgY29uc3QgY29ubmVjdGlvblByb21pc2UgPSBwb3N0Z3Jlc2pzLnJlc2VydmUoKTtcblxuICAgICAgICBjb25zdCBjb25uZWN0aW9uUmVzdWx0ID0gYXdhaXQgUHJvbWlzZS5yYWNlKFtjb25uZWN0aW9uUHJvbWlzZSwgYWJvcnRpb25Qcm9taXNlXSk7XG5cbiAgICAgICAgaWYgKCFjb25uZWN0aW9uUmVzdWx0KSB7XG4gICAgICAgICAgdm9pZCBjb25uZWN0aW9uUHJvbWlzZS5jYXRjaCgoKSA9PiB7fSk7XG5cbiAgICAgICAgICByZXR1cm4gZ2V0QWJvcnRSZXN1bHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbm5lY3Rpb24gPSBjb25uZWN0aW9uUmVzdWx0O1xuXG4gICAgICAgIGlmIChhYm9ydFNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgICAgY29ubmVjdGlvbi5yZWxlYXNlKCk7XG5cbiAgICAgICAgICByZXR1cm4gZ2V0QWJvcnRSZXN1bHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHBpZFByb21pc2UgPSBnZXRDb25uZWN0aW9uUElEKGNvbm5lY3Rpb24pO1xuXG4gICAgICAgIGNvbnN0IHBpZFJlc3VsdCA9IGF3YWl0IFByb21pc2UucmFjZShbcGlkUHJvbWlzZSwgYWJvcnRpb25Qcm9taXNlXSk7XG5cbiAgICAgICAgaWYgKHBpZFJlc3VsdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdm9pZCBwaWRQcm9taXNlLmNhdGNoKCgpID0+IHt9KS5maW5hbGx5KCgpID0+IGNvbm5lY3Rpb24/LnJlbGVhc2UoKSk7XG5cbiAgICAgICAgICByZXR1cm4gZ2V0QWJvcnRSZXN1bHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhYm9ydFNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgICAgY29ubmVjdGlvbi5yZWxlYXNlKCk7XG5cbiAgICAgICAgICByZXR1cm4gZ2V0QWJvcnRSZXN1bHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHF1ZXJ5UHJvbWlzZSA9IGNvbm5lY3Rpb24udW5zYWZlKHF1ZXJ5LnNxbCwgcXVlcnkucGFyYW1ldGVycyBhcyBuZXZlcik7XG5cbiAgICAgICAgY29uc3QgcXVlcnlSZXN1bHQgPSBhd2FpdCBQcm9taXNlLnJhY2UoW3F1ZXJ5UHJvbWlzZSwgYWJvcnRpb25Qcm9taXNlXSk7XG5cbiAgICAgICAgaWYgKCFxdWVyeVJlc3VsdCkge1xuICAgICAgICAgIHZvaWQgUHJvbWlzZS5hbGxTZXR0bGVkKFtjYW5jZWxRdWVyeShwb3N0Z3Jlc2pzLCBwaWRSZXN1bHQhKSwgcXVlcnlQcm9taXNlXSkuZmluYWxseSgoKSA9PlxuICAgICAgICAgICAgY29ubmVjdGlvbj8ucmVsZWFzZSgpLFxuICAgICAgICAgICk7XG5cbiAgICAgICAgICByZXR1cm4gZ2V0QWJvcnRSZXN1bHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpO1xuXG4gICAgICAgIHJldHVybiBbbnVsbCwgcXVlcnlSZXN1bHQgYXMgbmV2ZXJdO1xuICAgICAgfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHtcbiAgICAgICAgY29ubmVjdGlvbj8ucmVsZWFzZSgpO1xuXG4gICAgICAgIHJldHVybiBbZXJyb3IgYXMgRXJyb3JdO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKGFib3J0TGlzdGVuZXIpIHtcbiAgICAgICAgICBhYm9ydFNpZ25hbD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFib3J0XCIsIGFib3J0TGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgfTtcbn1cblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1vYmplY3QtdHlwZVxuYXN5bmMgZnVuY3Rpb24gY2FuY2VsUXVlcnkocG9zdGdyZXNqczogU3FsLCBwaWQ6IHt9KTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHF1ZXJ5ID0gZ2V0Q2FuY2VsUXVlcnkocGlkKTtcblxuICB0cnkge1xuICAgIGF3YWl0IHBvc3RncmVzanMudW5zYWZlKHF1ZXJ5LnNxbCwgcXVlcnkucGFyYW1ldGVycyBhcyBuZXZlcik7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBjYW5jZWwgcXVlcnk6XCIsIGVycm9yKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRDb25uZWN0aW9uUElEKGNvbm5lY3Rpb246IFJlc2VydmVkU3FsKTogUHJvbWlzZTx1bmtub3duPiB7XG4gIGNvbnN0IHF1ZXJ5ID0gZ2V0UElEUXVlcnkoKTtcblxuICB0cnkge1xuICAgIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgY29ubmVjdGlvbi51bnNhZmU8UXVlcnlSZXN1bHQ8dHlwZW9mIHF1ZXJ5Pj4ocXVlcnkuc3FsLCBxdWVyeS5wYXJhbWV0ZXJzIGFzIG5ldmVyKTtcblxuICAgIHJldHVybiByZXN1bHQ/LnBpZDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGdldCBjb25uZWN0aW9uIFBJRDpcIiwgZXJyb3IpO1xuXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuIiwgImltcG9ydCB0eXBlIHsgUXVlcnksIFF1ZXJ5UmVzdWx0IH0gZnJvbSBcIi4vcXVlcnlcIjtcbmltcG9ydCB0eXBlIHsgRWl0aGVyIH0gZnJvbSBcIi4vdHlwZS11dGlsc1wiO1xuXG5leHBvcnQgaW50ZXJmYWNlIEV4ZWN1dG9yIHtcbiAgZXhlY3V0ZTxUPihxdWVyeTogUXVlcnk8VD4sIG9wdGlvbnM/OiBFeGVjdXRlT3B0aW9ucyk6IFByb21pc2U8RWl0aGVyPEVycm9yLCBRdWVyeVJlc3VsdDxRdWVyeTxUPj4+Pjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXF1ZW5jZUV4ZWN1dG9yIGV4dGVuZHMgRXhlY3V0b3Ige1xuICBleGVjdXRlU2VxdWVuY2U8VCwgUz4oXG4gICAgc2VxdWVuY2U6IHJlYWRvbmx5IFtRdWVyeTxUPiwgUXVlcnk8Uz5dLFxuICAgIG9wdGlvbnM/OiBFeGVjdXRlT3B0aW9ucyxcbiAgKTogUHJvbWlzZTxbW0Vycm9yXV0gfCBbW251bGwsIFF1ZXJ5UmVzdWx0PFF1ZXJ5PFQ+Pl0sIEVpdGhlcjxFcnJvciwgUXVlcnlSZXN1bHQ8UXVlcnk8Uz4+Pl0+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEV4ZWN1dGVPcHRpb25zIHtcbiAgYWJvcnRTaWduYWw/OiBBYm9ydFNpZ25hbDtcbn1cblxuZXhwb3J0IGNsYXNzIEFib3J0RXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKFwiVGhpcyBvcGVyYXRpb24gd2FzIGFib3J0ZWRcIik7XG4gICAgdGhpcy5uYW1lID0gXCJBYm9ydEVycm9yXCI7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEFib3J0UmVzdWx0KCk6IFtBYm9ydEVycm9yXSB7XG4gIHJldHVybiBbbmV3IEFib3J0RXJyb3IoKV07XG59XG4iLCAiaW1wb3J0IHtcbiAgdHlwZSBDb21waWxhYmxlLFxuICB0eXBlIERpYWxlY3RBZGFwdGVyLFxuICBEdW1teURyaXZlcixcbiAgdHlwZSBFeHByZXNzaW9uLFxuICB0eXBlIEV4cHJlc3Npb25CdWlsZGVyLFxuICBleHByZXNzaW9uQnVpbGRlcixcbiAgdHlwZSBFeHByZXNzaW9uV3JhcHBlcixcbiAgdHlwZSBJbnNlcnRPYmplY3QsXG4gIEt5c2VseSxcbiAgdHlwZSBLeXNlbHlQbHVnaW4sXG4gIE9wZXJhdGlvbk5vZGVUcmFuc2Zvcm1lcixcbiAgdHlwZSBQbHVnaW5UcmFuc2Zvcm1RdWVyeUFyZ3MsXG4gIHR5cGUgUGx1Z2luVHJhbnNmb3JtUmVzdWx0QXJncyxcbiAgdHlwZSBQcmltaXRpdmVWYWx1ZUxpc3ROb2RlLFxuICB0eXBlIFF1ZXJ5Q29tcGlsZXIsXG4gIHR5cGUgUXVlcnlSZXN1bHQgYXMgS3lzZWx5UXVlcnlSZXN1bHQsXG4gIHR5cGUgUm9vdE9wZXJhdGlvbk5vZGUsXG4gIHNxbCxcbiAgdHlwZSBTcWxCb29sLFxuICB0eXBlIFVua25vd25Sb3csXG4gIHR5cGUgVXBkYXRlT2JqZWN0LFxuICBWYWx1ZUxpc3ROb2RlLFxuICBWYWx1ZU5vZGUsXG4gIHR5cGUgV2hlcmVJbnRlcmZhY2UsXG59IGZyb20gXCJreXNlbHlcIjtcblxuaW1wb3J0IHR5cGUgeyBDb2x1bW4sIENvbHVtbkZpbHRlciwgRmlsdGVyR3JvdXAsIFRhYmxlIH0gZnJvbSBcIi4vYWRhcHRlclwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIEJ1aWxkZXJSZXF1aXJlbWVudHMge1xuICBBZGFwdGVyOiB7IG5ldyAoKTogRGlhbGVjdEFkYXB0ZXIgfTtcbiAgbm9QYXJhbWV0ZXJzPzogYm9vbGVhbjtcbiAgUXVlcnlDb21waWxlcjogeyBuZXcgKCk6IFF1ZXJ5Q29tcGlsZXIgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEJ1aWxkZXI8REI+KHJlcXVpcmVtZW50czogQnVpbGRlclJlcXVpcmVtZW50cyk6IEt5c2VseTxEQj4ge1xuICByZXR1cm4gbmV3IEt5c2VseSh7XG4gICAgZGlhbGVjdDoge1xuICAgICAgY3JlYXRlQWRhcHRlcjogKCkgPT4gbmV3IHJlcXVpcmVtZW50cy5BZGFwdGVyKCksXG4gICAgICBjcmVhdGVEcml2ZXI6ICgpID0+IG5ldyBEdW1teURyaXZlcigpLFxuICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciAtIHdlIGRvbid0IG5lZWQgYnVpbHQtaW4gaW50cm9zcGVjdGlvbiBpbiB0aGlzIGNhc2VcbiAgICAgIGNyZWF0ZUludHJvc3BlY3RvcjogKCkgPT4gbnVsbCxcbiAgICAgIGNyZWF0ZVF1ZXJ5Q29tcGlsZXI6ICgpID0+IG5ldyByZXF1aXJlbWVudHMuUXVlcnlDb21waWxlcigpLFxuICAgIH0sXG4gICAgcGx1Z2luczogWy4uLihyZXF1aXJlbWVudHMubm9QYXJhbWV0ZXJzID8gW25ldyBJbW1lZGlhdGVWYWx1ZVBsdWdpbigpXSA6IFtdKV0sXG4gIH0pO1xufVxuXG4vKipcbiAqIEEgcGx1Z2luIHRoYXQgdHJhbnNmb3JtcyBhbGwgdmFsdWVzIHRvIGltbWVkaWF0ZSB2YWx1ZXMuIFRoaXMgbWVhbnMgdGhlaXIgaW5qZWN0ZWQgaW50byB0aGUgU1FMIHN0cmluZyBpbnN0ZWFkIG9mIHBvcHVsYXRpbmcgdGhlIHBhcmFtZXRlcnMgYXJyYXkuXG4gKiBJbiBzb21lIHNpdHVhdGlvbnMsIGEgZGF0YWJhc2UgZHJpdmVyIG1pZ2h0IG5vdCBzdXBwb3J0IHBhcmFtZXRlcnMsIGFuZCB0aGlzIHBsdWdpbiBjYW4gYmUgdXNlZCB0byB3b3JrIGFyb3VuZCB0aGF0LlxuICovXG5jbGFzcyBJbW1lZGlhdGVWYWx1ZVBsdWdpbiBpbXBsZW1lbnRzIEt5c2VseVBsdWdpbiB7XG4gIHJlYWRvbmx5ICN0cmFuc2Zvcm1lciA9IG5ldyBJbW1lZGlhdGVWYWx1ZVRyYW5zZm9ybWVyKCk7XG5cbiAgdHJhbnNmb3JtUXVlcnkoYXJnczogUGx1Z2luVHJhbnNmb3JtUXVlcnlBcmdzKTogUm9vdE9wZXJhdGlvbk5vZGUge1xuICAgIHJldHVybiB0aGlzLiN0cmFuc2Zvcm1lci50cmFuc2Zvcm1Ob2RlKGFyZ3Mubm9kZSk7XG4gIH1cblxuICB0cmFuc2Zvcm1SZXN1bHQoYXJnczogUGx1Z2luVHJhbnNmb3JtUmVzdWx0QXJncyk6IFByb21pc2U8S3lzZWx5UXVlcnlSZXN1bHQ8VW5rbm93blJvdz4+IHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGFyZ3MucmVzdWx0KTtcbiAgfVxufVxuXG5jbGFzcyBJbW1lZGlhdGVWYWx1ZVRyYW5zZm9ybWVyIGV4dGVuZHMgT3BlcmF0aW9uTm9kZVRyYW5zZm9ybWVyIHtcbiAgcHJvdGVjdGVkIG92ZXJyaWRlIHRyYW5zZm9ybVByaW1pdGl2ZVZhbHVlTGlzdChub2RlOiBQcmltaXRpdmVWYWx1ZUxpc3ROb2RlKTogUHJpbWl0aXZlVmFsdWVMaXN0Tm9kZSB7XG4gICAgcmV0dXJuIFZhbHVlTGlzdE5vZGUuY3JlYXRlKG5vZGUudmFsdWVzLm1hcChWYWx1ZU5vZGUuY3JlYXRlSW1tZWRpYXRlKSkgYXMgbmV2ZXI7XG4gIH1cblxuICBvdmVycmlkZSB0cmFuc2Zvcm1WYWx1ZShub2RlOiBWYWx1ZU5vZGUpOiBWYWx1ZU5vZGUge1xuICAgIHJldHVybiB7IC4uLnN1cGVyLnRyYW5zZm9ybVZhbHVlKG5vZGUpLCBpbW1lZGlhdGU6IHRydWUgfTtcbiAgfVxufVxuXG5kZWNsYXJlIGNvbnN0IHF1ZXJ5VHlwZTogdW5pcXVlIHN5bWJvbDtcbmV4cG9ydCBpbnRlcmZhY2UgUXVlcnk8VCA9IFJlY29yZDxzdHJpbmcsIHVua25vd24+PiB7XG4gIFtxdWVyeVR5cGVdPzogVDtcbiAgcGFyYW1ldGVyczogcmVhZG9ubHkgdW5rbm93bltdO1xuICBzcWw6IHN0cmluZztcbiAgdHJhbnNmb3JtYXRpb25zPzogUGFydGlhbDxSZWNvcmQ8a2V5b2YgVCwgXCJqc29uLXBhcnNlXCI+Pjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFzUXVlcnk8VD4ocXVlcnk6IHN0cmluZyB8IFF1ZXJ5PHVua25vd24+KTogUXVlcnk8VD4ge1xuICBpZiAodHlwZW9mIHF1ZXJ5ID09PSBcInN0cmluZ1wiKSB7XG4gICAgcmV0dXJuIHsgcGFyYW1ldGVyczogW10sIHNxbDogcXVlcnkgfSBhcyBuZXZlcjtcbiAgfVxuXG4gIHJldHVybiBxdWVyeSBhcyBuZXZlcjtcbn1cblxuZXhwb3J0IHR5cGUgUXVlcnlSZXN1bHQ8VD4gPVxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICBUIGV4dGVuZHMgUXVlcnk8aW5mZXIgUj4gPyBSW10gOiBUIGV4dGVuZHMgKC4uLmFyZ3M6IGFueVtdKSA9PiBRdWVyeTxpbmZlciBSPiA/IFJbXSA6IG5ldmVyO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbXBpbGVPcHRpb25zPFQ+IHtcbiAgLyoqXG4gICAqIEEgbWFwcGluZyBvZiBjb2x1bW4gbmFtZXMgdG8gdHJhbnNmb3JtYXRpb25zIHRoYXQgc2hvdWxkIGJlIGFwcGxpZWQgdG8gdGhlIHJlc3VsdC5cbiAgICogQ3VycmVudGx5IHN1cHBvcnRlZCB0cmFuc2Zvcm1hdGlvbiBpcyBcImpzb24tcGFyc2VcIiwgd2hpY2ggcGFyc2VzIGEgSlNPTiBzdHJpbmcgaW50byBhbiBvYmplY3QuXG4gICAqL1xuICB0cmFuc2Zvcm1hdGlvbnM/OiBQYXJ0aWFsPFJlY29yZDxrZXlvZiBULCBcImpzb24tcGFyc2VcIj4+O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZTxUID0gUmVjb3JkPHN0cmluZywgdW5rbm93bj4+KFxuICBjb21waWxlYWJsZTogQ29tcGlsYWJsZTxUPixcbiAgb3B0aW9ucz86IENvbXBpbGVPcHRpb25zPFQ+LFxuKTogUXVlcnk8VD4ge1xuICBjb25zdCBjb21waWxlZFF1ZXJ5ID0gY29tcGlsZWFibGUuY29tcGlsZSgpO1xuXG4gIHJldHVybiB7XG4gICAgcGFyYW1ldGVyczogY29tcGlsZWRRdWVyeS5wYXJhbWV0ZXJzLFxuICAgIHNxbDogY29tcGlsZWRRdWVyeS5zcWwsXG4gICAgdHJhbnNmb3JtYXRpb25zOiBvcHRpb25zPy50cmFuc2Zvcm1hdGlvbnMsXG4gIH07XG59XG5cbi8qKlxuICogQXBwbGllcyBhIGZpbHRlciB0byB0aGUgZ2l2ZW4gcm93cyBiYXNlZCBvbiB0aGUgcHJpbWFyeSBrZXkgY29sdW1ucyBvZiB0aGUgdGFibGUuXG4gKlxuICogQGV4YW1wbGUgZGIuc2VsZWN0RnJvbShcInVzZXJzXCIpLiRjYWxsKGFwcGx5SW5mZXJyZWRSb3dGaWx0ZXJzKHJvd3MsIGNvbHVtbnMpKS5zZWxlY3RBbGwoKVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlJbmZlcnJlZFJvd0ZpbHRlcnMocm93czogUmVjb3JkPHN0cmluZywgdW5rbm93bj5bXSwgY29sdW1uczogVGFibGVbXCJjb2x1bW5zXCJdKSB7XG4gIGNvbnN0IHJvd0ZpbHRlcnMgPSBpbmZlclJvd0ZpbHRlcnMocm93cywgY29sdW1ucyk7XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgcmV0dXJuIDxRQiBleHRlbmRzIFdoZXJlSW50ZXJmYWNlPGFueSwgYW55Pj4ocWI6IFFCKTogUUIgPT5cbiAgICBxYi53aGVyZSgoZWIpID0+IHtcbiAgICAgIHJldHVybiBlYi5vcihcbiAgICAgICAgcm93RmlsdGVycy5tYXAoKHJvd0ZpbHRlcikgPT4ge1xuICAgICAgICAgIHJldHVybiBlYi5hbmQoXG4gICAgICAgICAgICByb3dGaWx0ZXIubWFwKChbY29sdW1uTmFtZSwgdmFsdWVdKSA9PlxuICAgICAgICAgICAgICBlYihjb2x1bW5OYW1lLCB2YWx1ZSA9PT0gbnVsbCA/IFwiaXNcIiA6IEFycmF5LmlzQXJyYXkodmFsdWUpID8gXCJpblwiIDogXCI9XCIsIHZhbHVlKSxcbiAgICAgICAgICAgICksXG4gICAgICAgICAgKTtcbiAgICAgICAgfSksXG4gICAgICApO1xuICAgIH0pIGFzIG5ldmVyO1xufVxuXG4vKipcbiAqIFBhcnQgb2YgYSBmaWx0ZXIgdGhhdCBwcmVkaWN0cyBhIG1hdGNoLlxuICogaWUuIC4uLiBXSEVSRSAkQ29sdW1OYW1lID0gJFZhbHVlIC4uLlxuICovXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxudHlwZSBSb3dGaWx0ZXJQcmVkaWNhdGUgPSBbQ29sdW1uTmFtZTogc3RyaW5nIHwgRXhwcmVzc2lvbjxhbnk+LCBWYWx1ZTogdW5rbm93bl07XG5cbi8qKlxuICogQSByb3cgZmlsdGVyIGlzIGNvbXByaXNlZCBvZiBvbmUgb3IgbW9yZSBwcmVkaWNhdGVzLlxuICovXG50eXBlIFJvd0ZpbHRlciA9IFJvd0ZpbHRlclByZWRpY2F0ZVtdO1xuXG4vKipcbiAqIFJvdyBmaWx0ZXJzIGlzIHNpbXBseSBhIHNldCBvZiBtdWx0aXBsZSB7QGxpbmsgUm93RmlsdGVyfS5cbiAqL1xudHlwZSBSb3dGaWx0ZXJzID0gUm93RmlsdGVyW107XG5cbi8qKlxuICogSW5mZXJzIHRoZSBmaWx0ZXIgdGhhdCBpcyBuZWNlc3NhcnkgdG8gdW5pcXVlbHkgaWRlbnRpZnkgYSBnaXZlbiByb3dcbiAqIGluZGl2aWR1YWxseS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluZmVyRmlsdGVyT2JqZWN0KHJvdzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sIGNvbHVtbnM6IFRhYmxlW1wiY29sdW1uc1wiXSk6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHtcbiAgY29uc3QgZmlsdGVyOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHt9O1xuXG4gIGZvciAoY29uc3QgY29sdW1uIG9mIE9iamVjdC52YWx1ZXMoY29sdW1ucykpIHtcbiAgICBjb25zdCB7IGlzSW5QcmltYXJ5S2V5LCBuYW1lOiBjb2x1bW5OYW1lIH0gPSBjb2x1bW47XG5cbiAgICBpZiAoIWlzSW5QcmltYXJ5S2V5KSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBmaWx0ZXJbY29sdW1uTmFtZV0gPSByb3dbY29sdW1uTmFtZV0gPz8gbnVsbDtcbiAgfVxuXG4gIHJldHVybiBmaWx0ZXI7XG59XG5cbi8qKlxuICogSW5mZXJzIHRoZSBmaWx0ZXIgdGhhdCBpcyBuZWNlc3NhcnkgdG8gdW5pcXVlbHkgaWRlbnRpZnkgbXVsdGlwbGUgcm93c1xuICogaW5kaXZpZHVhbGx5LlxuICpcbiAqIEVsZWdhbnRseSBpbmZlcnMgdGhlIGJlc3QgcG9zc2libGUgc3RhdGVtZW50IHRvIGZpbHRlciB3aXRoLlxuICogVE9ETzogaW50cm9zcGVjdCBwcmltYXJ5IGtleSBvcmRpbmFsIG51bWJlcnMgc28gdGhlIHR1cGxlIGlzIGluIHRoZSBjb3JyZWN0IG9yZGVyLlxuICogVE9ETzogaWYgd2UgZXZlciBzdXBwb3J0IE1TU1FMLCB3ZSdsbCBuZWVkIHRvIGRyb3AgdG8gZHVtYiAoLi4uIGFuZCAuLi4pIG9yICguLi4gYW5kIC4uLikgbGlrZSBpbiB0aGUgb2xkIHdheSBqdXN0IGZvciBNU1NRTC5cbiAqXG4gKiBGb3Igc2luZ2xlIGNvbHVtbiBwcmltYXJ5IGtleTpcbiAqXG4gKiAxLiBpZiBvbmx5IDEgcm93OiBjb2wgPSB2YWx1ZVxuICogMi4gaWYgbXVsdGlwbGUgcm93czogY29sIElOICh2YWx1ZTEsIHZhbHVlMiwgLi4uKVxuICpcbiAqIEZvciBjb21wb3NpdGUgcHJpbWFyeSBrZXk6XG4gKlxuICogMS4gaWYgb25seSAxIHJvdzogKGNvbDEsIGNvbDIsIC4uLikgPSAodmFsdWUxLCB2YWx1ZTIsIC4uLilcbiAqIDIuIGlmIG11bHRpcGxlIHJvd3M6IChjb2wxLCBjb2wyLCAuLi4pIElOICgodmFsdWUxYSwgdmFsdWUyYSwgLi4uKSwgKHZhbHVlMWIsIHZhbHVlMmIsIC4uLiksIC4uLilcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluZmVyUm93RmlsdGVycyhyb3dzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPltdLCBjb2x1bW5zOiBUYWJsZVtcImNvbHVtbnNcIl0pOiBSb3dGaWx0ZXJzIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgY29uc3QgcmVmczogRXhwcmVzc2lvbldyYXBwZXI8YW55LCBhbnksIGFueT5bXSA9IFtdO1xuICBjb25zdCB2YWx1ZXM6IHVua25vd25bXSA9IFtdO1xuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gIGNvbnN0IGViID0gZXhwcmVzc2lvbkJ1aWxkZXI8YW55LCBhbnk+KCk7XG5cbiAgZm9yIChjb25zdCByb3cgb2Ygcm93cykge1xuICAgIGNvbnN0IHZhbHVlc0ZvclJvdzogdW5rbm93bltdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGNvbHVtbiBvZiBPYmplY3QudmFsdWVzKGNvbHVtbnMpKSB7XG4gICAgICBjb25zdCB7IGlzSW5QcmltYXJ5S2V5LCBuYW1lOiBjb2x1bW5OYW1lIH0gPSBjb2x1bW47XG5cbiAgICAgIGlmICghaXNJblByaW1hcnlLZXkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChyb3cgPT09IHJvd3MuYXQoMCkpIHtcbiAgICAgICAgcmVmcy5wdXNoKGViLnJlZihjb2x1bW5OYW1lKSk7XG4gICAgICB9XG5cbiAgICAgIHZhbHVlc0ZvclJvdy5wdXNoKHRyYW5zZm9ybVZhbHVlKHJvd1tjb2x1bW5OYW1lXSA/PyBudWxsLCBjb2x1bW4pKTtcbiAgICB9XG5cbiAgICB2YWx1ZXMucHVzaChyZWZzLmxlbmd0aCA9PT0gMSA/IHZhbHVlc0ZvclJvdy5hdCgwKSEgOiB0dXBsZUZyb20odmFsdWVzRm9yUm93KSk7XG4gIH1cblxuICBjb25zdCBsaHMgPSByZWZzLmxlbmd0aCA9PT0gMSA/IHJlZnMuYXQoMCkhIDogdHVwbGVGcm9tKHJlZnMpO1xuICBjb25zdCByaHMgPSB2YWx1ZXMubGVuZ3RoID09PSAxID8gdmFsdWVzLmF0KDApISA6IHZhbHVlcztcblxuICByZXR1cm4gW1tbbGhzLCByaHNdXV07XG59XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5mdW5jdGlvbiB0dXBsZUZyb20oaXRlbXM6IHVua25vd25bXSk6IEV4cHJlc3Npb248YW55PiB7XG4gIHJldHVybiBzcWxgKCR7c3FsLmpvaW4oaXRlbXMsIHNxbGAsIGApfSlgO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlUcmFuc2Zvcm1hdGlvbnM8QyBleHRlbmRzIFwiaW5zZXJ0XCIgfCBcInVwZGF0ZVwiPihcbiAgX2NvbnRleHQ6IEMsXG4gIHZhbHVlczogQyBleHRlbmRzIFwidXBkYXRlXCIgPyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHwgUmVjb3JkPHN0cmluZywgdW5rbm93bj5bXSxcbiAgY29sdW1uczogVGFibGVbXCJjb2x1bW5zXCJdLFxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuKTogQyBleHRlbmRzIFwidXBkYXRlXCIgPyAoKSA9PiBVcGRhdGVPYmplY3Q8YW55LCBhbnk+IDogKCkgPT4gSW5zZXJ0T2JqZWN0PGFueSwgYW55PiB8IEluc2VydE9iamVjdDxhbnksIGFueT5bXSB7XG4gIHJldHVybiAoKSA9PlxuICAgIEFycmF5LmlzQXJyYXkodmFsdWVzKSA/IHZhbHVlcy5tYXAoKHJvdykgPT4gdHJhbnNmb3JtVmFsdWVzKHJvdywgY29sdW1ucykpIDogdHJhbnNmb3JtVmFsdWVzKHZhbHVlcywgY29sdW1ucyk7XG59XG5cbmZ1bmN0aW9uIHRyYW5zZm9ybVZhbHVlcyhcbiAgdmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPixcbiAgY29sdW1uczogVGFibGVbXCJjb2x1bW5zXCJdLFxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuKTogSW5zZXJ0T2JqZWN0PGFueSwgYW55PiB8IFVwZGF0ZU9iamVjdDxhbnksIGFueT4ge1xuICBpZiAoT2JqZWN0LmtleXModmFsdWVzKS5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4geyBbT2JqZWN0LmtleXMoY29sdW1ucykuYXQoMCkhXTogc3FsYGRlZmF1bHRgIH07XG4gIH1cblxuICByZXR1cm4gT2JqZWN0LmVudHJpZXModmFsdWVzKS5yZWR1Y2UoXG4gICAgKG9iaiwgW2tleSwgdmFsdWVdKSA9PiAoeyAuLi5vYmosIFtrZXldOiB0cmFuc2Zvcm1WYWx1ZSh2YWx1ZSwgY29sdW1uc1trZXldISkgfSksXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICB7fSBhcyBJbnNlcnRPYmplY3Q8YW55LCBhbnk+IHwgVXBkYXRlT2JqZWN0PGFueSwgYW55PixcbiAgKTtcbn1cblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2Zvcm1WYWx1ZSh2YWx1ZTogdW5rbm93biwgY29sdW1uOiBDb2x1bW4pOiBFeHByZXNzaW9uV3JhcHBlcjxhbnksIGFueSwgYW55PiB7XG4gIGNvbnN0IHsgZGF0YXR5cGUgfSA9IGNvbHVtbjtcblxuICBjb25zdCBlYiA9IGV4cHJlc3Npb25CdWlsZGVyKCk7XG5cbiAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgcmV0dXJuIGViLmxpdChudWxsKTtcbiAgfVxuXG4gIGlmICghZGF0YXR5cGUuaXNOYXRpdmUpIHtcbiAgICByZXR1cm4gZWIuY2FzdChlYi52YWwodmFsdWUpLCBzcWwuaWQoZGF0YXR5cGUuc2NoZW1hLCBkYXRhdHlwZS5uYW1lKSk7XG4gIH1cblxuICByZXR1cm4gZWIudmFsKHZhbHVlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNlbGVjdEZpbHRlckV4cHJlc3Npb24oXG4gIGZpbHRlcnM6IChDb2x1bW5GaWx0ZXIgfCBGaWx0ZXJHcm91cClbXSxcbiAgY29sdW1uczogVGFibGVbXCJjb2x1bW5zXCJdLFxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuKTogKGViOiBFeHByZXNzaW9uQnVpbGRlcjxhbnksIGFueT4pID0+IEV4cHJlc3Npb248U3FsQm9vbD4ge1xuICBpZiAoZmlsdGVycy5sZW5ndGggPT09IDApIHJldHVybiAoZWIpID0+IGViLmxpdCh0cnVlKTsgLy8gbm8gZmlsdGVycywgYWx3YXlzIHRydWVcblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICBjb25zdCBvckdyb3Vwc09mQW5kQnVpbGRlcnM6ICgoZWI6IEV4cHJlc3Npb25CdWlsZGVyPGFueSwgYW55PikgPT4gRXhwcmVzc2lvbjxTcWxCb29sPilbXVtdID0gW107XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gIGxldCBjdXJyZW50QW5kR3JvdXBCdWlsZGVyczogKChlYjogRXhwcmVzc2lvbkJ1aWxkZXI8YW55LCBhbnk+KSA9PiBFeHByZXNzaW9uPFNxbEJvb2w+KVtdID0gW107XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWx0ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgY3VycmVudEFuZEdyb3VwQnVpbGRlcnMucHVzaChidWlsZEJhc2VFeHByZXNzaW9uQnVpbGRlcihmaWx0ZXJzW2ldISwgY29sdW1ucykpO1xuXG4gICAgLy8gJm4gQU5EIGdyb3VwIGVuZHMgaWYgaXQncyB0aGUgbGFzdCBmaWx0ZXIsIG9yIHRoZSBpdGVtIGlzIGZvbGxvd2VkIGJ5IGFuICdvcidcbiAgICBpZiAoaSA9PT0gZmlsdGVycy5sZW5ndGggLSAxIHx8IGZpbHRlcnNbaV0hLmFmdGVyID09PSBcIm9yXCIpIHtcbiAgICAgIG9yR3JvdXBzT2ZBbmRCdWlsZGVycy5wdXNoKGN1cnJlbnRBbmRHcm91cEJ1aWxkZXJzKTtcbiAgICAgIGN1cnJlbnRBbmRHcm91cEJ1aWxkZXJzID0gW107IC8vIHN0YXJ0IGEgbmV3IGdyb3VwXG4gICAgfVxuICB9XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgcmV0dXJuIChlYjogRXhwcmVzc2lvbkJ1aWxkZXI8YW55LCBhbnk+KSA9PiB7XG4gICAgY29uc3QgYW5kRXhwcmVzc2lvbnMgPSBvckdyb3Vwc09mQW5kQnVpbGRlcnMubWFwKChncm91cCkgPT4ge1xuICAgICAgcmV0dXJuIGViLmFuZChncm91cC5tYXAoKGJ1aWxkZXIpID0+IGJ1aWxkZXIoZWIpKSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZWIub3IoYW5kRXhwcmVzc2lvbnMpO1xuICB9O1xufVxuXG4vLyBIZWxwZXIgdG8gYnVpbGQgYW4gZXhwcmVzc2lvbiBidWlsZGVyIGZvciBhIHNpbmdsZSBmaWx0ZXIgb3IgYSBncm91cFxuZnVuY3Rpb24gYnVpbGRCYXNlRXhwcmVzc2lvbkJ1aWxkZXIoXG4gIHNwZWM6IENvbHVtbkZpbHRlciB8IEZpbHRlckdyb3VwLFxuICBjb2x1bW5zOiBUYWJsZVtcImNvbHVtbnNcIl0sXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4pOiAoZWI6IEV4cHJlc3Npb25CdWlsZGVyPGFueSwgYW55PikgPT4gRXhwcmVzc2lvbjxTcWxCb29sPiB7XG4gIGlmIChzcGVjLmtpbmQgPT09IFwiQ29sdW1uRmlsdGVyXCIpIHtcbiAgICByZXR1cm4gKGViKSA9PiB7XG4gICAgICBjb25zdCB7IGNvbHVtbiwgb3BlcmF0b3IsIHZhbHVlIH0gPSBzcGVjO1xuXG4gICAgICBjb25zdCBjb2x1bW5NZXRhID0gY29sdW1uc1tjb2x1bW5dITtcblxuICAgICAgcmV0dXJuIGViKFxuICAgICAgICBjb2x1bW5NZXRhLmRhdGF0eXBlLmdyb3VwID09PSBcInJhd1wiID8gZWIuY2FzdChjb2x1bW4sIFwidGV4dFwiKSA6IGNvbHVtbixcbiAgICAgICAgb3BlcmF0b3IsXG4gICAgICAgIHRyYW5zZm9ybVZhbHVlKHZhbHVlLCBjb2x1bW5NZXRhKSxcbiAgICAgICk7XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiBnZXRTZWxlY3RGaWx0ZXJFeHByZXNzaW9uKHNwZWMuZmlsdGVycywgY29sdW1ucyk7XG59XG4iLCAiaW1wb3J0IHsgYXNRdWVyeSwgdHlwZSBRdWVyeSB9IGZyb20gXCIuLi9xdWVyeVwiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UElEUXVlcnkoKTogUXVlcnk8eyBwaWQ6IHVua25vd24gfT4ge1xuICByZXR1cm4gYXNRdWVyeShcInNlbGVjdCBwZ19iYWNrZW5kX3BpZCgpIGFzIHBpZFwiKTtcbn1cblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1vYmplY3QtdHlwZVxuZXhwb3J0IGZ1bmN0aW9uIGdldENhbmNlbFF1ZXJ5KHBpZDoge30pOiBRdWVyeTx1bmtub3duPiB7XG4gIHJldHVybiB7XG4gICAgcGFyYW1ldGVyczogW3BpZF0sXG4gICAgc3FsOiBcInNlbGVjdCBwZ19jYW5jZWxfYmFja2VuZCgkMSk7XCIsXG4gIH07XG59XG4iXSwKICAibWFwcGluZ3MiOiAieWFBQUEsSUFBQUEsRUFBQSxHQUFBQyxFQUFBRCxFQUFBLDhCQUFBRSxJQUFBLGVBQUFDLEVBQUFILEdDa0JPLElBQU1JLEVBQU4sY0FBeUIsS0FBTSxDQUNwQyxhQUFjLENBQ1osTUFBTSw0QkFBNEIsRUFDbEMsS0FBSyxLQUFPLFlBQ2QsQ0FDRixFQUVPLFNBQVNDLEdBQStCLENBQzdDLE1BQU8sQ0FBQyxJQUFJRCxDQUFZLENBQzFCLENDdURPLFNBQVNFLEVBQVdDLEVBQTBDLENBQ25FLE9BQUksT0FB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cyIsICJfX2V4cG9ydCIsICJjcmVhdGVQb3N0Z3Jlc0pTRXhlY3V0b3IiLCAiX190b0NvbW1vbkpTIiwgIkFib3J0RXJyb3IiLCAiZ2V0QWJvcnRSZXN1bHQiLCAiYXNRdWVyeSIsICJxdWVyeSIsICJnZXRQSURRdWVyeSIsICJhc1F1ZXJ5IiwgImdldENhbmNlbFF1ZXJ5IiwgInBpZCIsICJjcmVhdGVQb3N0Z3Jlc0pTRXhlY3V0b3IiLCAicG9zdGdyZXNqcyIsICJxdWVyeSIsICJvcHRpb25zIiwgImFib3J0U2lnbmFsIiwgImVycm9yIiwgImdldEFib3J0UmVzdWx0IiwgImFib3J0TGlzdGVuZXIiLCAiY29ubmVjdGlvbiIsICJhYm9ydGVkIiwgImFib3J0aW9uUHJvbWlzZSIsICJyZXNvbHZlIiwgImNvbm5lY3Rpb25Qcm9taXNlIiwgImNvbm5lY3Rpb25SZXN1bHQiLCAicGlkUHJvbWlzZSIsICJnZXRDb25uZWN0aW9uUElEIiwgInBpZFJlc3VsdCIsICJxdWVyeVByb21pc2UiLCAicXVlcnlSZXN1bHQiLCAiY2FuY2VsUXVlcnkiLCAicGlkIiwgImdldENhbmNlbFF1ZXJ5IiwgImdldFBJRFF1ZXJ5IiwgInJlc3VsdCJdCn0K